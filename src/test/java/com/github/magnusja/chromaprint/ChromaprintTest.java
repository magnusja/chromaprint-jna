package com.github.magnusja.chromaprint;

import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;

import javax.sound.sampled.AudioInputStream;
import javax.sound.sampled.AudioSystem;
import java.net.URL;
import java.util.HashMap;
import java.util.Map;

/**
 * Created by magnusja on 08/07/17.
 */
public class ChromaprintTest {

    private static Map<URL, String> tests = new HashMap<URL, String>();

    @Before
    public void setUp() throws Exception {
        tests.put(new URL("http://www.music.helsinki.fi/tmt/opetus/uusmedia/esim/a2002011001-e02.wav"), "AQABoQo13piP3obVPUg-5DnO49TRHD96Bk2VDzty7tB5VKZwxO5I4Pjxw8c__ODhF-PhHx1DnDnxF8-M6UUPPcUF_xHuDM8UcMJxBtlzJGGio-WH5sUzoY90lDoeJcSuNMGvgImQRFyKWOFxPSia48nxB7dxJUyDwy8iJMlxSUlQJcp09Mxx4o9C_Njeg9cxivKh5mkK8_jhkd-C489w50OVmUi4HCF5HB-uY1-CbAl1KNL-4Dlw7Pjx4XCiQ6McHPnBKwd2fD4uNDmT4KmiID2SwwuP80ngHsUVoj-aIA91JHU-Y0d_-BGO4z9w5fjgvuAHp0cbkN4x6kcfGv7R3NBTXEeTP4nwScYfF-VyHI9CYn4hPfgOH9eJR7PAGleIHw8lTGtGGWEeJN3x4A_hl_jxzcQf_JmCc0fDMah-5Ejyo3uC_ygfHH-G-SKapAyq77hyJEf-47jUpsJz4z_-BP_RPEj2G--O-7hq7E9ILA8qsQ7EaS9-_Ljgbsd-vCr2K1CPNGFQH8-DH8dxEleC87g6NIlUpjgU8gK1PsK9S9h2VDm-4DySxwnSNfLx4cpzfHvwHBWN92jK5MiVI6nkPHg4qng_PCmaONEi1FKO46M2PM9wSUj_GK8HPcdDqPyDPMxx7sOF5kN_5A-eK9CpjcgnJMt1hBeeDPqHPQPPMPjR6EN_PMfx5NClBF_24Mcf9MrRPAMfjIZufLFxPkO3Ef5R6eLxfMGHy_BZPO-QLBGlWEOoLEtcHM2P6aDZJVCe6XDF47jz4oeXBZdQM_hRpUdyEfmN-viO99jxC84FJ_VRfhaO64T2ZcrQnA947MZ1_JKOLgyRfkiYE-3l4Bf-4CqaF31wXohfHbKPcduJXiryHThx4cfWH0-CY-PxgqPComFykN7xY0o--OihW3hyOGcy_GZwLjGOR8GPhwn0YvrRlMejFreOHw_xPPiH6VmQLNGRh09woflC9MM__BvuhMKjNAP8Hkdk5tB-5KXxHyfKOMep48WkxyGsHlcVfND4B_9x4rlT_Pg_PH3QH-kLrcddHD_2HZySo8sF5Qm6Zocm_QBhlOASGAIQpUIQJYSAwiKkrESAIaSAUoQAygQjSCBI1AVKCUgEkMQAR5BRjkCDiAMECCEME0QBJZgAwCKAFANIEO4YM0IARtEwDgTBHCIEGcMNIBARo5CgQACvCCAHGaKIAQAxYQSQiiAFiADCOeOwE4gBBqCAiIEGgFOMESKMMUYYBYBAwjDjAGOICcEMAQQAxBQyCAlCELACAKWgMY5ACBQi4hFAhGlIEYAZJQAQYohgwAIABFLUCoCEIMJRqBBhQADAmANAGCKYEsIowoABwFkkAKHKCMEkKwIZQpyABCECADFACmAIQYIQJJh0QimAkGVWYKMMM5RYjSRRwhBBgCBHCyAEAYA4RxgQxBEgiFKMeweAUogxaAgH4BJklACAEIooJ84wYAx1EAglhCBcKKeAIg4gQ4QCQCCnCATHACMQAooQgBQADiglAEKOCeW4c8Qw");
        tests.put(new URL("http://www.music.helsinki.fi/tmt/opetus/uusmedia/esim/a2002011001-e02-16kHz.wav"), "AQABoQo13piP3obVPUg-5DnO49TRHD96Bk2VDzty7tB5VKZwxO5I4Pjxw8c__ODhF-PhHx1DnDnxF8-M6UUPPcUF_xHuDM8UcMJxBtlzJGGio-WH5sUzoY90lDoeJcSuNMGvgImQRFyKWOFxPSia48nxB7dxJUyDwy8iJMlxSUlQJcp09Mxx4o9C_Njeg9cxivKh5mkK8_jhkd-C489w50OVmUi4HCF5HB-uY1-CbAl1KNL-4Dlw7Pjx4XCiQ6McHPnBKwd2fD4uNDmT4KmiID2SwwuP80ngHsUVoj-aIA91JHU-Y0d_-BGO4z9w5fjgvuAHp0cbkN4x6kcfGv7R3NBTXEeTP4nwScYfF-VyHI9CYn4hPfgOH9eJR7PAGleIHw8lTGtGGWEeJN3x4A_hl_jxzcQf_JmCc0fDMah-5Ejyo3uC_ygfHH-G-SKapAyq77hyJEf-47jUpsJz4z_-BP_RPEj2G--O-7hq7E9ILA8qsQ7EaS9-_Ljgbsd-vCr2K1CPNGFQH8-DH8dxEleC87g6NIlUpjgU8gK1PsK9S9h2VDm-4DySxwnSNfLx4cpzfHvwHBWN92jK5MiVI6nkPHg4qng_PCmaONEi1FKO46M2PM9wSUj_GK8HPcdDqPyDPMxx7sOF5kN_5A-eK9CpjcgnJMt1hBeeDPqHPQPPMPjR6EN_PMfx5NClBF_24Mcf9MrRPAMfjIZufLFxPkO3Ef5R6eLxfMGHy_BZPO-QLBGlWEOoLEtcHM2P6aDZJVCe6XDF47jz4oeXBZfQB_9RpUdyEfmN-viO99jxC84FJ_VRfhaO64T2ZcrQnA947MZ1_JKOLgyRfkiYE-3l4Bf-4CqaF31wXohfHbKPcduJXiryHThx4cfWH0-CY-PxgqPComFykN7xY0o--OihW3hyOGcy_GZwLjGOR8GPhwn0YvrRlMejFreOHw_xPPiH6VmQLNGRh09woflC9MM_fMPlhMKjNAPM9UBkBtppIe_x57hQZtLxC8ekxyGsHlcVfND4B_9x4rlT_Pg_PH3QH-kLrcddHD_2HZySo8sF5Qm6Zocm_QBhlOASGAIQpUIQJYSAwiKkrESAIaSAUoQAygQjSCBI1AVKCUgEkMQAR5BRjkCDiAMECCEME0QBJZgAwCKAFANIEO4YM0IARtEwDgTBHCIEGcMNIBARo5CgQACvCCAHGaKIAQAxYQSQiiAFiADCOeOwE4gBBqCAiIEGgFOMESKMMUYYBYBAwjDjAGOICcEMAQQAxBQyCAlCELACAKWgMY5ACBQi4hFAhGlIEYAZJQAQYohgwAIABFLUCoCEIMJRqBBhQADAmANAGCKYEsIowoABwFkkAKHKCMEkKwIZQpyABCECADFACmAIQYIQJJh0QimAkGUGAYGNMsxQYjWSRAlDBAGCHC2AEAQA4hxhQBBHgCBKMe4dAEohxqAhHIBLkFECAEIoopw4w4Ax1EEglBCCcKGcwsAhAQwASCqCwTHACISAIgQgBYADSgmAkGNCOe4cMQw");
        //tests.put(new URL("http://www.music.helsinki.fi/tmt/opetus/uusmedia/esim/a2002011001-e02-ulaw.wav"), "AQABoQo13piP3obVPUg-5DnO49TRHD96Bk2VDzty7tB5VKZwxO5I4Pjxw8c__ODhF-PhHx1DnDnxF8-M6UUPPcUF_xHuDM8UcMJxBtlzJGGio-WH5sUzoY90lDoeJcSuNMGvgImQRFyKWMmOPyia48nxB7dxJUyDwy8iJMlxSUlQJcp09Mxx4o9C_Njeg9cxivKh5mkK8_jhkd-C489w50OVmUi4HCF5HB-uY1-CbAl1KNL-4Dlw7Pjx4XCiQ6McHPnBKwd2fD4uNDmT4KmiID2SwwuP80ngHsUVoj-aIA91JHU-Y0d_-BGO4z9w5fjgvuAHp0cbkN4x6kcfGv7R3NBTXEeTP4nwScYfF-VyHI9CYn4hPfgOH9eJR7PAGleIHw8lTGtGGWEeJN3x4A_hl_jxzcQf_JmCc0fDMah-5Ejyo3uC_ygfHH-G-SKapAyq77hyJEf-47jUpsJz4z_-BP_RPEj2G--O-7hq7E9ILA8qsQ7EaS9-_Ljgbsd-vCr2K1CPNGFQH8-DH8dxEleC87g6NIlUpjgU8gK1PsK9S9h2VDm-4DySxwnSNfLx4cpzfHvwHBWN92jK5MiVI6nkPHg4qng_PCmaONEi1FKO46M2PM9wSUj_GK8HPcdDqPyDPMxx7sOF5kN_5A-eK9CpjcgnJMt1hBeeDPqHPQPPMPjR6EN_PMfx5NClBF_24Mcf9MrRPAMfjIZufLFxPkO3Ef5R6eLxfMGHy_BZPO-QLBGlWEOoLEtcHM2P6aDZJVCe6XDF47jz4oeXBZdQM_hRpUdyEfmN-viOucfxC84FJ_VRfhaO64T2ZcrQnA947MZ1_JKOLgyRfkiYE-3l4Bf-4CqaF31wXohfHbKPcduJXiryHThx4cfWH0-CY-PxgqPComFykN7xY0o--OihW3hyOGcy_GZwLjGOR8GPhwn0YvrRlMejFreOHw_xPPiH6VmQLNGRh09woflC9MM__BvuhMKjNAP8Hkdk5tB-5KXxHyfKbDnu48WkxyGsHlcVfND4B_9x4rlTnMc_PH3QH-kLrcddHD_2HZySo8sF5Qm6Zocm_QBhlOASGAIQpUIQJYSAwiKkrESAIaSAUoQAygQjSCBI1AVKCUgEkMQAR5hRjkCDiAMECCEME0QBJZgAwCKAFANIEO4YM0IARtEwDgTBHCIEGcMNIBARo5CgQACvCCAHGaKIAQAxYQSQiiAFiADCOeOwE4gBBqCAiIEGgFOMESKMMUYYBYBAwjDjAGOICcEMAQQAxBQyCAlCELACAKWgMY5ACBQi4hFAhGlIEYAZJQAQYohgwAIABFLUCoCEIMJRqBBhQADAmANAGCKYEsIowoABwFkkAKHKCMEkKwIZQpyABCECADFACmAIQYIQJJh0QimAkGVWYKMMM9SCJIkShggCBDlaACEIAMQ5woAgjgBBlGLcOwCUQoxBQzgAlyCjBACEUEQ5cYYBY6iDQCghBOFCOQUUcQAZIhQAAjlFIDgGGIEQUIQAoJwDSgmAkGNCOe4cMQw");
        tests.put(new URL("http://www.music.helsinki.fi/tmt/opetus/uusmedia/esim/a2002011001-e02-8kHz.wav"), "AQABoarGGz96G-8eJPyQ52h53Edz9McZ-PmwI-cOnUdlCkfsDieOH_9h_MMP6ngxHu6PbglxMSdenMb0ED30FBf8R7gzPFPACccZZM-RhImOlh-aF8-EPhJKXXiUEFeaYLwCJkIScSliJTv-oGiOJ8cf3MaVMA0Ov4iQJMclJUGVKNPRMziPPwrxY3sPXscoyoeapynMH4cn8Vvw48OdD1VmIuFyhORxfPjxCRETy5Ci_cFz4MBzfDicKIfGB0d-8MqBHZ-PC03OJHiqKEiP5PDCo-SToDmKh_jhIA91JHU-Y0d_-BGO4z9w5fjgvuAHpwfT4N4x6kdfw8_R3NBTXEeTP4nwScafo1zy4vhC4i-U_MG3w8d14tEssMYV4sdDCdOaUUayPIh3PPhD-CV-fDPxB3-m4NzRcAyqHzmS_Oie4Ef5HMefYb6IJimD6juuHMmR_zjONhWeG-eOP8F_NA-S_ca74z6uGvsTEnwwSawDcdqL_XiOw92OH6-KX4HCI00Y1Hie48dxnMSV4DyuDk0ilSkuKLxArY9wT5WwDVWOLziP5HGCdI18fLjyHN8evDlq4z2aMjly5UgqOQ8ejireD0-KJk60CLWU4_ioDc8zXBLSP8Y_6MvxECr_IA9z4dwzXGg-9EcePFegUxuRC8lS6QgvPBn0Dyd2MQx4Htbx4zmO59ClBF_24Mcf9MrRPAMf3FBsfDfOZ-hM-Eeli8e_4ApqGc1ZPO-EZImoWQiVMS8eND-mg1665FDOTHDF4ziVF4eXBZeEPvjx9Eh2Eblu9PiO99jhXvgFJ_VRfhaO64T2ZcrQnA-W4z4u_JKOLgyRfkiYE-3l4Bf-4CqaF31wXohfHbKPcduJXiry4Tiu4Id77EmGY-NxUKFytMlBeh-OKfngo4eeCtfhnMnwm8G5xPjwDD8eJtBfTPnRH49a3Dp-7CGeB__QM0iWqEMePsGF5gvRD_9wbricUPjSDIffA1HDQC4thGuLP_hRZtLxV8CkxyGsHlcVfND_oD9OPHeK4__w9EF_pC-0HndxXMe-g1OOLhf0BNOaHZr0A0GMEoJKQACiSjBAlBACCnIRUkYgwBCxAChARBOMIIEgURcoJSARjjBHmFGOQIOIAwQIYRQTRAElmABAWaCYCUgQ7iBjAjCKDgMBCOYQIcgYbgCByFDGKBDAKwLIQYYoYgBAggkjAFQEKUAEEEggQxxQSCAGGIACIgYaAE4xRogwxhhhFABCCMOMA4whJgQzBBCAmEIGIUEIAlYAoJQyhhFogXJEFACIMA0pAjDiBBBDBAMWACAQoFYAJAQRjkKFCAMCAGSYA0AIApgSwhMGGHAWCSOYMEwwyQpBhhAnIEGIAACIAVIAY4ggBCDBJDBKAcSSsQJgYAw2lFgtAVHCEEGAIA1pIAQBgDhHGBDEESCIUqx7BzBBjBFoCACXIKMEAIRQRIkSzhgGjKEIAqGEIFwopyBwBiAApFHEGQMMEIgpQgAIwAGlBEDIIaGcd5AYBg");

    }

    @Test
    public void calculateFingerPrint() throws Exception {
        for(Map.Entry<URL, String> entry : tests.entrySet()) {
            URL url = entry.getKey();
            String hash = entry.getValue();
            AudioInputStream is = AudioSystem.getAudioInputStream(url);
            Chromaprint chromaprint = new Chromaprint(is);
            Fingerprint fingerprint = chromaprint.calculateFingerPrint();
            Assert.assertEquals(hash, fingerprint.getString());
        }
    }

}